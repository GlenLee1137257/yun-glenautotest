# 云测 UI 自动化操作手册

## 目录

- [一、详细操作指南](#一详细操作指南)
  - [1.1 创建测试用例](#11-创建测试用例)
  - [1.2 配置操作步骤](#12-配置操作步骤)
  - [1.3 如何获取元素定位表达式](#13-如何获取元素定位表达式)
  - [1.4 执行测试用例](#14-执行测试用例)
  - [1.5 查看测试报告](#15-查看测试报告)
  - [1.6 编辑和删除步骤](#16-编辑和删除步骤)
- [二、支持的操作类型](#二支持的操作类型)
  - [2.1 鼠标操作](#21-鼠标操作)
  - [2.2 键盘操作](#22-键盘操作)
  - [2.3 等待操作](#23-等待操作)
  - [2.4 浏览器操作](#24-浏览器操作)
  - [2.5 断言操作](#25-断言操作)
  - [2.6 支持的定位方式](#26-支持的定位方式)

---

## 一、详细操作指南

### 1.1 创建测试用例

**操作路径：** UI自动化 → 用例管理 → 新增UI用例

**必填字段：**

| 字段 | 说明 | 示例 |
|------|------|------|
| **用例名称** | 测试用例的名称 | "用户登录功能测试" |
| **所属模块** | 用例所属的业务模块 | "用户管理" |
| **浏览器** | 执行测试的浏览器 | Chrome（推荐） |
| **执行等级** | 用例的重要程度 | P0（最高优先级） |

**可选字段：**

- **描述**：用例的详细说明
- **标签**：用于分类和搜索

**注意事项：**

- 用例名称要清晰明确，便于后续查找和管理
- 执行等级建议：P0（核心功能）、P1（重要功能）、P2（一般功能）

### 1.2 配置操作步骤

**操作步骤：**

1. **点击"新增操作"按钮**
   - 在用例编辑页面，找到"操作步骤列表"区域
   - 点击 **新增操作** 按钮

2. **填写步骤基本信息**
   - **名称**：步骤的描述性名称（必填）
   - **步骤类型**：选择"本地步骤"（默认）

3. **选择操作类型**
   - 使用**级联选择器**选择操作类型
- 第一级：选择操作分类（浏览器、鼠标、键盘、等待、断言等）
- 第二级：选择具体操作（打开窗口、鼠标左键点击、键盘输入等）

4. **配置操作参数**
   
   根据操作类型，系统会自动显示需要的字段：

   **不需要定位的操作（只需填写"值"）：**
   - 打开窗口：填写 URL 地址
   - 强制等待：填写等待时间（毫秒）
   - 网页标题断言：填写期望的标题文本

   **需要定位的操作（需要填写定位方式、定位表达式、值）：**
   - 键盘输入：定位方式 + 定位表达式 + 输入的值
   - 鼠标点击：定位方式 + 定位表达式
   - 元素断言：定位方式 + 定位表达式 + 期望值

5. **配置可选参数**
   - **描述**：步骤的详细说明（可选）
   - **是否截图**：是否在执行该步骤时截图（建议在关键步骤开启）
   - **失败是否继续**：如果该步骤失败，是否继续执行后续步骤

6. **保存步骤**
   - 点击 **确定** 按钮保存
   - 步骤会出现在步骤列表中


### 1.3 如何获取元素定位表达式

**使用浏览器开发者工具：**

1. **打开要测试的网页**
   - 在浏览器中打开要测试的页面

2. **打开开发者工具**
   - 按 **F12** 键（Windows/Linux）
   - 或按 **Cmd+Option+I**（macOS）
   - 或右键点击页面 → 选择"检查"

3. **选择要定位的元素**
   - 点击开发者工具左上角的**元素选择器图标**（鼠标图标）
   - 将鼠标移动到页面上，点击要定位的元素
   - 元素会在 Elements 面板中高亮显示

4. **获取定位表达式**

   **方法一：使用 ID 定位（推荐）**
   - 查看元素的 `id` 属性
   - 例如：`<input id="username">`
   - 定位方式：**ID**
   - 定位表达式：`username`

   **方法二：使用 CSS 选择器**
   - 右键点击 Elements 面板中的元素
   - 选择 **Copy → Copy selector**
   - 定位方式：**CSS_SELECTOR**
   - 定位表达式：粘贴复制的选择器

   **方法三：使用 XPath**
   - 右键点击 Elements 面板中的元素
   - 选择 **Copy → Copy XPath**
   - 定位方式：**XPATH**
   - 定位表达式：粘贴复制的 XPath

   **方法四：使用 Class 名称**
   - 查看元素的 `class` 属性
   - 例如：`<button class="btn btn-primary">`
   - 定位方式：**CLASS_NAME**
   - 定位表达式：`btn-primary`（使用其中一个 class）

   **方法五：使用 Name 属性**
   - 查看元素的 `name` 属性
   - 例如：`<input name="username">`
   - 定位方式：**NAME**
   - 定位表达式：`username`

### 1.4 执行测试用例

**操作步骤：**

1. **进入用例管理页面**
   - 点击左侧菜单：**UI自动化 → 用例管理**

2. **找到要执行的用例**
   - 在用例列表中找到目标用例
   - 可以使用搜索框按名称搜索

3. **执行用例**
   - 点击用例右侧的 **执行** 按钮
   - 系统会弹出确认对话框
   - 点击 **确认** 开始执行

4. **等待执行完成**
   - 执行过程中，可以在页面上看到执行状态
   - 执行完成后，会自动跳转到测试报告页面

**执行状态说明：**

- **执行中**：用例正在执行，请耐心等待
- **执行成功**：所有步骤都执行成功
- **执行失败**：有步骤执行失败，查看报告了解详情

**注意事项：**

- 执行过程中不要关闭浏览器标签页
- 如果执行时间过长（超过5分钟），可能是页面加载慢或网络问题
- 执行失败时，查看报告中的错误信息，定位问题

### 1.5 查看测试报告

**报告入口：**

1. **执行完成后自动跳转**
   - 用例执行完成后，会自动跳转到报告详情页面

2. **从报告列表进入**
   - 点击左侧菜单：**测试报告 → UI测试**
   - 在报告列表中找到目标报告
   - 点击用例名称进入详情

**报告内容说明：**

**1. 执行概览**
- 用例名称、执行时间、总耗时
- 总步骤数、成功步骤数、失败步骤数
- 整体执行状态（✅ 成功 / ❌ 失败）

**2. 步骤详情列表**
- 每个步骤的详细信息：
  - 步骤名称、操作类型
  - 执行状态（✅ 成功 / ❌ 失败）
  - 执行耗时
  - 操作参数（定位方式、定位表达式、值等）
  - 截图（如果配置了）
  - 错误信息（如果失败）

**3. 查看截图**
- 如果步骤配置了截图，点击"查看截图"按钮
- 可以查看执行该步骤时的页面状态
- 对于失败的步骤，截图有助于排查问题

**4. 错误信息分析**
- 如果步骤失败，会显示详细的错误信息
- 常见错误类型：
  - 元素定位失败：找不到元素
  - 操作超时：元素未在指定时间内出现
  - 断言失败：实际值与期望值不匹配

### 1.6 编辑和删除步骤

**编辑步骤：**

1. 在步骤列表中，找到要编辑的步骤
2. 点击步骤右侧的 **编辑** 按钮
3. 在弹出的对话框中修改配置
4. 点击 **确定** 保存修改

**删除步骤：**

1. 在步骤列表中，找到要删除的步骤
2. 点击步骤右侧的 **删除** 按钮
3. 在确认对话框中点击 **确认**
4. 步骤会被删除（注意：此操作不可恢复）

**调整步骤顺序：**

- 步骤会按照"排序"字段自动排序
- 执行时按照排序从小到大的顺序执行
- 如果需要调整顺序，可以编辑步骤的"排序"字段

**注意事项：**

- 删除步骤后，后续步骤的排序会自动调整
- 建议在删除前先查看用例，确认不会影响其他步骤
- 编辑步骤时，注意检查定位表达式是否正确

---

## 二、支持的操作类型

### 2.1 鼠标操作

| 操作 | 说明 | 需要配置的字段 | 使用场景 |
|------|------|--------------|---------|
| **鼠标左键点击** | 单击元素 | 定位方式 + 定位表达式 | 点击按钮、链接 |
| **鼠标右键点击** | 右键点击元素 | 定位方式 + 定位表达式 | 打开右键菜单 |
| **鼠标左键双击** | 双击元素 | 定位方式 + 定位表达式 | 双击文件、列表项 |
| **鼠标移入元素** | 鼠标悬停在元素上 | 定位方式 + 定位表达式 | 触发悬停效果、显示提示 |
| **鼠标拖拽元素到目标元素** | 拖拽元素到目标位置 | 源元素定位 + 目标元素定位 | 拖拽排序、文件上传 |

**使用场景：**
- **左键点击**：最常用的操作，用于点击按钮、链接、复选框等
- **移入元素**：测试悬停效果，如显示下拉菜单、提示信息
- **拖拽**：测试拖拽功能，如拖拽排序、拖拽上传

### 2.2 键盘操作

| 操作 | 说明 | 需要配置的字段 | 使用场景 |
|------|------|--------------|---------|
| **键盘输入** | 在输入框中输入文本 | 定位方式 + 定位表达式 + 值 | 输入用户名、密码、搜索关键词 |
| **清空输入框** | 清空输入框内容 | 定位方式 + 定位表达式 | 清空表单字段 |
| **表单提交** | 提交表单 | 定位方式 + 定位表达式 | 提交表单（通常用点击提交按钮代替） |

**使用场景：**
- **键盘输入**：最常用的操作，用于在输入框中输入文本
- **清空输入框**：在输入新值之前，先清空旧值

### 2.3 等待操作

| 操作 | 说明 | 需要配置的字段 | 使用场景 |
|------|------|--------------|---------|
| **强制等待** | 固定等待指定时间 | 值（毫秒数） | 等待页面加载、等待动画完成 |
| **隐式等待** | 等待元素出现（全局生效） | 值（毫秒数） | 设置全局等待策略 |

**等待时间设置建议：**

- **页面加载**：通常 2-5 秒
- **网络请求**：根据接口响应时间，通常 3-5 秒
- **动画效果**：根据动画时长，通常 1-2 秒
- **元素出现**：如果使用隐式等待，通常设置 5-10 秒

**强制等待 vs 隐式等待：**

- **强制等待**：固定等待指定时间，无论元素是否出现
- **隐式等待**：如果元素立即出现则不等待，如果未出现则等待最多指定时间
- **建议**：优先使用强制等待，简单可控；隐式等待适合元素出现时间不确定的场景

### 2.4 浏览器操作

| 操作 | 说明 | 需要配置的字段 | 示例 |
|------|------|--------------|------|
| **打开窗口** | 打开指定 URL | 值（URL地址） | `https://www.example.com` |
| **关闭窗口** | 关闭当前窗口 | 无 | - |
| **最大化窗口** | 最大化浏览器窗口 | 无 | - |
| **设置窗口大小** | 设置浏览器窗口大小 | 值（宽x高） | `1920x1080` |
| **浏览器前进** | 前进到下一页 | 无 | - |
| **浏览器后退** | 返回上一页 | 无 | - |
| **浏览器刷新** | 刷新当前页面 | 无 | - |
| **切换窗口** | 切换到其他浏览器标签页 | 无 | - |

**使用场景：**
- **打开窗口**：每个测试用例的第一步，通常用来打开要测试的页面
- **浏览器后退/前进**：测试浏览器的导航功能
- **刷新页面**：测试页面刷新后的状态

### 2.5 断言操作

**浏览器属性断言：**

| 断言类型 | 说明 | 需要配置的字段 | 示例 |
|---------|------|--------------|------|
| **网页标题相等** | 验证标题完全匹配 | 预期值 | `"登录页面"` |
| **网页标题包含** | 验证标题包含关键词 | 预期值 | `"登录"` |
| **网页URL相等** | 验证URL完全匹配 | 预期值 | `"https://example.com/login"` |
| **网页URL包含** | 验证URL包含关键词 | 预期值 | `"/login"` |

**元素文本断言：**

| 断言类型 | 说明 | 需要配置的字段 | 示例 |
|---------|------|--------------|------|
| **元素文本相等** | 验证元素文本完全匹配 | 定位方式 + 定位表达式 + 预期值 | `"登录成功"` |
| **元素文本包含** | 验证元素文本包含关键词 | 定位方式 + 定位表达式 + 预期值 | `"成功"` |
| **元素文本大于** | 验证元素文本（数字）大于期望值 | 定位方式 + 定位表达式 + 预期值 | `"100"` |
| **元素文本小于** | 验证元素文本（数字）小于期望值 | 定位方式 + 定位表达式 + 预期值 | `"50"` |

**元素状态断言：**

| 断言类型 | 说明 | 需要配置的字段 | 使用场景 |
|---------|------|--------------|---------|
| **元素存在** | 验证元素存在于页面 | 定位方式 + 定位表达式 | 验证登录后用户菜单出现 |
| **元素不存在** | 验证元素不存在于页面 | 定位方式 + 定位表达式 | 验证删除后元素消失 |
| **元素可见** | 验证元素可见 | 定位方式 + 定位表达式 | 验证提示信息显示 |
| **元素不可见** | 验证元素不可见 | 定位方式 + 定位表达式 | 验证加载完成后加载动画消失 |
| **元素启用** | 验证元素可交互 | 定位方式 + 定位表达式 | 验证按钮可点击 |
| **元素禁用** | 验证元素不可交互 | 定位方式 + 定位表达式 | 验证按钮禁用状态 |

**断言使用建议：**

- 在关键操作后添加断言，验证操作结果
- 建议在用例的最后一步添加断言，验证整体流程是否成功
- 对于重要的验证点，建议开启截图，方便后续排查

### 2.6 支持的定位方式

| 元素定位类型 | 说明 | 示例 | 推荐度 |
|---------|------|------|--------|
| **ID** | id定位 | `username` | ⭐⭐⭐⭐⭐ 最推荐 |
| **NAME** | 名称定位 | `username` | ⭐⭐⭐⭐ 推荐 |
| **CSS_SELECTOR** | CSS选择器定位 | `#username` 或 `.btn-primary` | ⭐⭐⭐⭐ 推荐 |
| **XPATH** | xpath定位 | `//input[@id='username']` | ⭐⭐⭐ 功能强大但性能较低 |
| **CLASS_NAME** | 类名定位 | `btn-primary`（直接写 class 属性值，无点号） | ⭐⭐⭐ 适合有唯一 class 的元素 |
| **TAG_NAME** | 标签名称定位 | `button` | ⭐⭐ 通常需要结合其他方式 |
| **LINK_TEXT** | 链接文本内容定位 | `登录` | ⭐⭐⭐ 适合链接元素 |
| **PARTIAL_LINK_TEXT** | 全部链接文本内容定位 | `登` | ⭐⭐ 适合链接元素 |

**定位方式选择建议：**

1. **优先使用 ID**：如果元素有唯一的 `id`，优先使用 ID 定位（最稳定、性能最好）
2. **其次使用 NAME**：表单元素通常有 `name` 属性，适合表单场景
3. **再次使用 CSS_SELECTOR**：灵活且性能好，适合复杂场景
4. **最后使用 XPATH**：功能强大但性能较低，适合 ID、NAME、CSS 都无法定位的场景

#### CLASS_NAME 与 CSS_SELECTOR 的区别

**相同点：**
- 两者都用于定位 HTML 元素中的 `class` 属性
- 两者都定位 `<body>` 中的 HTML 元素

**不同点：**

| 对比项 | CLASS_NAME | CSS_SELECTOR |
|--------|-----------|--------------|
| **表达式写法** | 直接写 class 属性值，**不需要点号** | 使用 CSS 选择器语法，**需要点号开头** |
| **示例** | `btn-primary` | `.btn-primary` |
| **语法来源** | HTML 的 class 属性值 | CSS 选择器语法规则 |
| **灵活性** | 只能定位单个 class 值 | 可以组合多个条件，更灵活 |
| **适用场景** | 元素只有一个 class 值，且该 class 值唯一 | 需要组合多个 class 或标签的场景 |


**避免使用的定位方式：**

- ❌ 过长的 XPath：`/html/body/div[1]/div[2]/div[3]/form/input[1]`（页面结构变化容易失效）
- ❌ 索引定位：`//div[5]/span[2]`（页面改动易失效）
- ⚠️ 动态生成的 ID：`react-id-123456`（每次刷新可能变化）

---

