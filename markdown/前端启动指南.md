# 前端启动指南

## 问题描述

访问 `http://localhost:5173/#/login` 时显示：
```
ERR_CONNECTION_REFUSED
localhost 拒绝了我们的连接请求
```

## 原因分析

**后端服务状态**：✅ 正常
- gateway-service、account-service、data-service、engine-service 都已成功注册到 Nacos

**前端服务状态**：❌ 未启动
- Vite 开发服务器（端口 5173）没有运行
- 需要启动前端开发服务器

## 解决方案

### 步骤1：进入前端目录

打开终端，进入前端项目目录：

```bash
cd frontend/xdclass-cloud-test-main
```

### 步骤2：检查依赖是否已安装

检查 `node_modules` 目录是否存在：

```bash
# Windows PowerShell
if (Test-Path "node_modules") { Write-Host "依赖已安装" } else { Write-Host "需要安装依赖" }

# 或直接查看
dir node_modules
```

**如果 `node_modules` 目录不存在**，需要先安装依赖（见步骤3）。

### 步骤3：安装依赖（如果尚未安装）

如果 `node_modules` 目录不存在，需要先安装依赖：

```bash
# 使用 pnpm（推荐）
pnpm install

# 或使用 npm
npm install
```

等待依赖安装完成（可能需要几分钟）。

### 步骤4：启动前端开发服务器

安装完依赖后，启动开发服务器：

```bash
# 使用 pnpm
pnpm dev

# 或使用 npm
npm run dev
```

### 步骤5：验证前端服务是否启动成功

启动成功后，终端会显示类似以下信息：

```
  VITE v5.0.10  ready in 1234 ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
  ➜  press h + enter to show help
```

### 步骤6：访问前端页面

在浏览器中访问：
- **登录页面**：http://localhost:5173/#/login
- **首页**：http://localhost:5173/

## 完整启动流程（从头开始）

### 如果前端目录是空的或没有安装依赖：

```bash
# 1. 进入前端目录
cd frontend/xdclass-cloud-test-main

# 2. 安装依赖（首次需要）
pnpm install
# 或
npm install

# 3. 启动开发服务器
pnpm dev
# 或
npm run dev
```

### 如果依赖已安装，直接启动：

```bash
# 1. 进入前端目录
cd frontend/xdclass-cloud-test-main

# 2. 启动开发服务器
pnpm dev
# 或
npm run dev
```

## 常见问题

### Q: 提示 `pnpm: command not found` 或 `pnpm 不是内部或外部命令`？

A: 需要先安装 pnpm：

```bash
# 使用 npm 安装 pnpm
npm install -g pnpm

# 或使用 npm 直接运行
npm install
npm run dev
```

### Q: 依赖安装失败或很慢？

A: 
1. 检查网络连接
2. 可以使用国内镜像加速：
   ```bash
   # 使用淘宝镜像
   npm config set registry https://registry.npmmirror.com
   
   # 然后重新安装
   npm install
   ```

### Q: 端口 5173 已被占用？

A: 
1. 查找占用端口的进程：
   ```bash
   # Windows
   netstat -ano | findstr :5173
   
   # 或使用 PowerShell
   netstat -ano | Select-String ":5173"
   ```
2. 关闭占用端口的进程，或修改 Vite 配置使用其他端口

### Q: 启动后显示编译错误？

A: 
1. 检查 Node.js 版本（建议使用 Node.js 16+）
2. 删除 `node_modules` 和 `pnpm-lock.yaml`（或 `package-lock.json`），重新安装
3. 查看错误信息，解决具体问题

### Q: 前端启动成功，但仍然无法访问后端？

A: 
1. 检查后端服务是否都在运行
2. 检查 `frontend/xdclass-cloud-test-main/src/composables/custom-fetch.ts` 中的 `baseUrl` 配置
   - 应该是 `http://localhost:8000`（Gateway 端口）
3. 检查 Gateway 服务是否正常运行在端口 8000

## 验证清单

启动前端前，确保：

- [ ] Node.js 已安装（`node -v` 显示版本号）
- [ ] pnpm 或 npm 已安装（`pnpm -v` 或 `npm -v` 显示版本号）
- [ ] 前端依赖已安装（`node_modules` 目录存在）
- [ ] 后端服务都已启动并注册到 Nacos
- [ ] Gateway 服务运行在端口 8000

## 快速命令参考

```bash
# 进入前端目录
cd frontend/xdclass-cloud-test-main

# 安装依赖
pnpm install        # 或 npm install

# 启动开发服务器
pnpm dev           # 或 npm run dev

# 停止服务器
# 在运行服务器的终端按 Ctrl + C
```

## 提示

- **前端开发服务器需要一直运行**，关闭终端窗口会导致前端服务停止
- 如果修改了前端代码，Vite 会自动热更新，无需手动刷新页面
- 生产环境部署时，需要先构建前端项目（`pnpm build`），然后部署构建产物
